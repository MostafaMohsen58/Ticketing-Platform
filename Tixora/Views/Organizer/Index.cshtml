@model IEnumerable<Tixora.Models.Organizer>

@{
    ViewData["Title"] = "Organizers";
}
<style>
    .table {
        border-collapse: collapse;
        width: 100%;
    }

        .table td, .table th {
            padding: 12px 15px;
            text-align: center;
            font-size: 16px;
            color: #222533;
        }

        .table thead {
            background-color: #2f3138;
        }

            .table thead th {
                color: #ffffff;
                font-weight: bold;
                text-transform: uppercase;
                letter-spacing: 1px;
                background-color: #0e1b4d;
                transition: background-color 0.3s ease;
            }

        .table tbody tr:hover {
            background-color: #f0f0f0;
            cursor: pointer;
        }

        .table tbody td {
            background-color: #ffffff;
            transition: background-color 0.3s ease;
        }

    .btn {
        border-radius: 5px;
        padding: 8px 16px;
        transition: background-color 0.3s ease, transform 0.3s ease;
        font-size: 14px;
    }

        .btn:hover {
            opacity: 0.8;
            font-weight: bold;
            transform: scale(1.05);
        }

        .btn:focus {
            outline: none;
            box-shadow: none;
        }

    .btn-details {
        background-color: #94B4C1;
        color: #ffffff;
    }

    .btn-edit {
        background-color: #547792;
        color: #ffffff;
        margin-left: 5px;
    }

    .btn-delete {
        background-color: #0e1b4d;
        color: #ffffff;
        margin-left: 5px;
    }
</style>

<div class="container mt-5">
    <div class="text-start mb-3">
        <a asp-action="Create" class="btn" style="background-color: #f82249; color: #ffffff; font-size: 16px;">Create New Organizer</a>
    </div>

    <div class="table-responsive">
        <table class="table table-bordered table-hover text-center">
            <thead>
                <tr>
                    <th>@Html.DisplayNameFor(model => model.Name)</th>
                    <th>@Html.DisplayNameFor(model => model.ContactEmail)</th>
                    <th>@Html.DisplayNameFor(model => model.ContactPhone)</th>
                    <th>Logo</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@Html.DisplayFor(modelItem => item.Name)</td>
                        <td>@Html.DisplayFor(modelItem => item.ContactEmail)</td>
                        <td>@Html.DisplayFor(modelItem => item.ContactPhone)</td>
                        <td>
                            @if (!string.IsNullOrEmpty(item.LogoUrl))
                            {
                                <img src="/images/user/@item.LogoUrl" alt="Logo" style="max-height: 50px; max-width: 50px;" />
                            }
                        </td>
                        <td>
                            <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-details">Details</a>
                            <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-edit">Edit</a>
                            <button type="button" class="btn btn-delete" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                    data-id="@item.Id" data-name="@item.Name" data-logo="@item.LogoUrl">
                                Delete
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="max-width: 500px;">
        <div class="modal-content" style="background-color: #ffffff;">
            <div class="modal-header" style="background-color: #0e1b4d; color: white;">
                <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="O"></button>
            </div>
            <div class="modal-body" style="background-color: #ffffff; color: #0e1b4d; font-weight: bold; font-size: 16px;">
                <div id="organizerLogoContainer" class="text-center mb-3">
                    <img id="organizerLogo" src="" alt="Logo" style="max-height: 100px; max-width: 150px; display: none;" />
                </div>
                <p><strong>Organizer Name: </strong><span id="organizerName"></span></p>
                <p>Are you sure you want to delete this organizer? This action cannot be undone.</p>
            </div>
            <div class="modal-footer" style="background-color: #ffffff;">
                <form id="deleteForm" asp-action="Delete" method="post">
                    <input type="hidden" id="organizerId" name="id" />
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn" style="background-color: #f82249; color: white;">Yes</button>
                    <button type="button" class="btn" style="background-color: white; color: #f82249; border: 2px solid #f82249;" data-bs-dismiss="modal">No</button>
                </form>
            </div>
        </div>
    </div>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div id="successPopup" class="modal fade" tabindex="-1" aria-labelledby="successPopupLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content" style="background-color: #0e1b4d;">
                <div class="modal-header" style="background-color: #0e1b4d; color: white;">
                    <h5 class="modal-title" id="successPopupLabel">Success</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="background-color: #ffffff; color: #0e1b4d; font-weight: bold;">
                    @TempData["SuccessMessage"]
                </div>
                <div class="modal-footer" style="background-color: #ffffff;">
                    <button type="button" class="btn" style="background-color: #f82249; color: white;" data-bs-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var deleteModal = document.getElementById('deleteModal');
            deleteModal.addEventListener('show.bs.modal', function (event) {
                var button = event.relatedTarget;
                var id = button.getAttribute('data-id');
                var name = button.getAttribute('data-name');
                var logo = button.getAttribute('data-logo');

                document.getElementById('organizerId').value = id;
                document.getElementById('organizerName').innerText = name;

                var organizerLogo = document.getElementById('organizerLogo');
                if (logo) {
                    organizerLogo.src = '/images/user/' + logo;
                    organizerLogo.style.display = 'block';
                } else {
                    organizerLogo.style.display = 'none';
                }
            });

        @if (TempData["SuccessMessage"] != null)
        {
            <text>
                        $(document).ready(function () {
                            $('#successPopup').modal('show');
                        });
            </text>
        }
        });
    </script>
}
